<!DOCTYPE html>
<html>
  <head>
    <title>Review Exam</title>
    <link rel="stylesheet" href="/style.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  </head>
  <body>
    <h1 id="header" class="header"></h1>
    <main id="review">
      <a id="goBackHome" href="http://cs490testcenter.ddns.net:50000/portal/s/Home.php">
        <button class="btn btn-success submit">GO BACK HOME</button>
      </a>
    </main>

    <script>

      const urlParams = new URLSearchParams(window.location.search);
      var requestType = 'ReviewExamFTM';
      const examID = urlParams.get('examID');

      function displayExams(){
        const data = {examID, requestType};

        const options = {
          method:'POST',
          headers: {
              "Content-type": "application/json; charset=UTF-8"
          },
          body: JSON.stringify(data)
        };
        
        fetch('http://cs490testcenter.ddns.net:50000/portal/frontBrowser.php', options)
        .then(response => {
          return response.json();
        })
        .then(data => {
          const header = document.getElementById("header");
          header.innerHTML = data.examData.examName;

          const points = document.createTextNode("Grade: " + data.examData.PointsEarned + "/" + data.examData.TotalPoints);
          document.getElementById('review').insertBefore(points, document.getElementById("goBackHome"));
          document.getElementById('review').insertBefore(document.createElement("br"), document.getElementById("goBackHome"));
          document.getElementById('review').insertBefore(document.createElement("br"), document.getElementById("goBackHome"));
          // points.setAttribute("class", "");

          for(let i = 0; i < data.answers.length; i++){
            const div = document.createElement("div");

            const question = document.createElement("label");
            question.setAttribute("class", "container")
            
            question.appendChild(document.createTextNode("Question " + (i+1)));
            question.appendChild(document.createElement("br"));

            question.appendChild(document.createTextNode(data.answers[i].pointsCorrect + " / " + data.answers[i].points));
            question.appendChild(document.createElement("br"));

            question.appendChild(document.createTextNode("Type: " + data.answers[i].type));
            question.appendChild(document.createElement("br"));

            question.appendChild(document.createTextNode("Difficulty: " + data.answers[i].difficulty));
            question.appendChild(document.createElement("br"));

            question.appendChild(document.createTextNode("Question: " + data.answers[i].question));
            question.appendChild(document.createElement("br"));

            input = document.createElement("textarea");
            input.readOnly = "true";
            input.setAttribute("rows", "15");
            input.setAttribute("cols", "95");
            input.innerHTML = data.answers[i].answer;
            
            question.appendChild(document.createElement("br"));
            question.appendChild(input);

            question.appendChild(document.createElement("br"));
            question.appendChild(document.createTextNode("Comments: " + data.answers[i].comments));
            
            div.appendChild(question);

            const reviewTable = document.createElement("table");
            reviewTable.setAttribute("class", "table");

            const reviewTableHead = document.createElement("thead");
            const tableRow1 = document.createElement("tr");
            tableRow1.setAttribute("class", "filters");

            const tableHeader1 = document.createElement("th");
            tableHeader1.innerHTML = "Case";
            
            const tableHeader2 = document.createElement("th");
            tableHeader2.innerHTML = "Input";

            const tableHeader3 = document.createElement("th");
            tableHeader3.innerHTML = "Output";

            const tableHeader4 = document.createElement("th");
            tableHeader4.innerHTML = "Points";

            tableRow1.appendChild(tableHeader1);
            tableRow1.appendChild(tableHeader2);
            tableRow1.appendChild(tableHeader3);
            tableRow1.appendChild(tableHeader4);

            reviewTableHead.appendChild(tableRow1);
            reviewTable.appendChild(reviewTableHead);

            const tableBody = document.createElement("tbody");
            for(let i=0; i < 0; i++) {
              const tableRowTR = document.createElement("tr");

              const tableBody1 = document.createElement("td");
              tableBody1.innerHTML = "1";
              
              const tableBody2 = document.createElement("td");
              tableBody2.innerHTML = "2";

              const tableBody3 = document.createElement("td");
              tableBody3.innerHTML = "3";

              const tableBody4 = document.createElement("td");
              tableBody4.innerHTML = "4";

              tableRowTR.appendChild(tableBody1);
              tableRowTR.appendChild(tableBody2);
              tableRowTR.appendChild(tableBody3);
              tableRowTR.appendChild(tableBody4);

              tableBody.appendChild(tableRowTR);
            }
            reviewTable.appendChild(tableBody);

            question.appendChild(reviewTable);

            document.getElementById("review").insertBefore(div, document.getElementById("goBackHome"));
            document.getElementById("review").insertBefore(document.createElement("br"), document.getElementById("goBackHome"));
            document.getElementById("review").insertBefore(document.createElement("br"), document.getElementById("goBackHome"));
          }
        })
        .catch((error) => {
          console.error('Error:', error);
        });
                
      };
      
      displayExams();
    </script>
  </body>
</html> 